<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<title>Доставка и плащане</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100">

<div class="max-w-6xl mx-auto p-6 bg-white rounded-lg shadow-md mt-6">
    <h1 class="text-3xl font-bold mb-4">Доставка</h1>

    <!-- Продукти в количката -->
    <div id="checkout-cart" class="mb-6"></div>
    <p id="total-price" class="text-xl font-semibold mb-6"></p>

    <!-- Форма за данни -->
    <form id="checkout-form" class="space-y-4">
        <div>
            <label class="block text-sm font-medium">Име и фамилия *</label>
            <input type="text" name="name" required class="w-full border rounded p-2">
        </div>
        <div>
            <label class="block text-sm font-medium">Телефон *</label>
            <input type="tel" name="phone" required class="w-full border rounded p-2">
        </div>
        <div>
            <label class="block text-sm font-medium">Имейл *</label>
            <input type="email" name="email" required class="w-full border rounded p-2">
        </div>
        <div>
            <label class="block text-sm font-medium">Начин на доставка *</label>
            <select id="delivery-method" name="delivery" required class="w-full border rounded p-2">
                <option value="">Избери</option>
                <option value="econt">Еконт</option>
            </select>
        </div>
        <div id="econt-offices" class="hidden">
            <label class="block text-sm font-medium">Офис на Еконт *</label>
            <select name="econt-office" required class="w-full border rounded p-2">
                <option value="">Избери офис</option>
                <option value="София Център">София Център</option>
                <option value="Пловдив Център">Пловдив Център</option>
                <option value="Варна Център">Варна Център</option>
            </select>
        </div>
        <div>
            <label class="block text-sm font-medium">Забележка</label>
            <textarea name="note" class="w-full border rounded p-2"></textarea>
        </div>
        <div>
            <label class="block text-sm font-medium">Начин на плащане *</label>
            <input type="text" value="В офиса" disabled class="w-full border rounded p-2 bg-gray-100">
        </div>

        <!-- Бутон -->
        <div class="flex justify-between">
            <button type="button" onclick="window.location.href='cart.html'" class="px-6 py-2 bg-gray-300 rounded hover:bg-gray-400">Назад</button>
            <button type="submit" class="px-6 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Потвърди поръчката</button>
        </div>
    </form>
</div>

<!-- Pop-up за потвърждение -->
<div id="popup" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center">
    <div class="bg-white p-6 rounded shadow-lg max-w-sm text-center">
        <h2 class="text-xl font-bold mb-4">Поръчката е приета!</h2>
        <p>Ще се свържем с вас за потвърждение.</p>
        <button onclick="window.location.href='index.html'" class="mt-4 px-4 py-2 bg-blue-500 text-white rounded">ОК</button>
    </div>
</div>

<script>
// Показване на количката
function renderCheckoutCart() {
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    const container = document.getElementById("checkout-cart");
    let total = 0;
    container.innerHTML = "";

    if (cart.length === 0) {
        container.innerHTML = "<p>Количката е празна.</p>";
        document.getElementById("total-price").innerText = "";
        return;
    }

    cart.forEach(item => {
        const subtotal = item.price * item.quantity;
        total += subtotal;
        container.innerHTML += `
            <div class="flex justify-between border p-2 rounded mb-2">
                <span>${item.name} x ${item.quantity}</span>
                <span>${subtotal.toFixed(2)} лв.</span>
            </div>
        `;
    });

    document.getElementById("total-price").innerText = `Общо: ${total.toFixed(2)} лв.`;
}

// Показване на офисите на Еконт
document.getElementById("delivery-method").addEventListener("change", function() {
    document.getElementById("econt-offices").classList.toggle("hidden", this.value !== "econt");
});

// Изпращане на формата
document.getElementById("checkout-form").addEventListener("submit", function(e) {
    e.preventDefault();
    const form = e.target;
    if (!form.checkValidity()) {
        form.reportValidity();
        return;
    }
    // Тук може да се добави реално изпращане към сървър
    document.getElementById("popup").classList.remove("hidden");
    localStorage.removeItem("cart"); // изчистване на количката
});

renderCheckoutCart();
</script>

</body>
</html>
